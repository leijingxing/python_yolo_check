# AI 情绪与姿态健康监控系统 (AI Emotion & Posture Health Monitor)

这是一个基于计算机视觉的智能健康监控助手。利用 **YOLOv8** 和 **YOLO11** 强大的目标检测与姿态估计能力，实时监控用户的情绪状态和坐姿健康，提供智能提醒与数据统计功能。

---

## 🚀 核心功能

### 1. 实时情绪识别
- 自动检测并识别 8 种面部表情：**开心/微笑、愤怒、悲伤、中性、惊讶、恐惧、厌恶、满足**。
- 实时记录情绪数据到本地数据库。

### 2. 智能坐姿矫正
- 利用 **YOLO11-Pose** 实时分析人体骨架关键点。
- 监测肩膀倾斜角度，当**倾斜超过 25°** 时，触发红色警示线、声音提示及系统弹窗通知。

### 3. 久坐健康提醒
- 自动追踪用户的连续就坐时长。
- 当**连续就坐超过 1 小时**时，发送系统通知提醒用户起立活动。
- 支持离座检测：用户离开超过 30 秒自动重置计时。

### 4. 异常状态报警
- **愤怒预警**：检测到持续超过 3 秒的愤怒情绪时发出提醒，建议放松心情。
- **防打扰机制**：所有报警均设有 30 秒冷却时间，避免频繁弹窗打扰工作。

### 5. 数据统计与分析
- 内置数据分析工具，可生成日报/周报/月报。
- 统计各类情绪出现频率及占比，帮助用户了解自己的情绪变化趋势。

---

## 🛠️ 环境依赖与安装

### 1. 依赖库
本项目基于 Python 开发，主要依赖库包括：
- `ultralytics`: YOLO 模型推理核心库
- `opencv-python`: 图像处理
- `plyer`: 发送 Windows 系统通知
- `winsound`: (Windows自带) 声音提示

### 2. 安装步骤

建议使用 Python 3.8+ 环境。

```bash
# 克隆项目 (或下载源码)
git clone <your-repo-url>
cd python_yolo

# 安装依赖
pip install ultralytics opencv-python plyer
```

### 3. 模型准备
程序会自动处理模型加载，但首次运行需要联网下载：
- **表情模型**: 项目自带 (位于 `YoloV8-Human-Emotion-Detection/best.pt`)
- **姿态模型**: `yolo11n-pose.pt` (首次运行 `main.py` 时会自动从 Ultralytics 官方下载)

---

## 💻 使用指南

### 1. 启动监控系统
连接摄像头，运行主程序：

```bash
python main.py
```
- **操作**：程序启动后会打开摄像头窗口。
    - **绿色骨架**：坐姿正常。
    - **红色骨架**：坐姿不正（报警）。
    - **左上角文字**：显示 `Sitting: HH:MM:SS` (久坐时长)。
- **退出**：在视频窗口按 **`q`** 键退出。

### 2. 查看数据报告
监控过程中会产生数据，运行分析脚本查看统计报告：

```bash
python analyze_emotion.py
```
该脚本将一次性输出：
- 全部历史数据统计
- **今日 (Today)** 数据统计
- **本周 (Week)** 数据统计
- **本月 (Month)** 数据统计

---

## ⚙️ 参数配置

您可以在 `main.py` 顶部的配置区域调整监控规则：

```python
# --- 监控参数配置 ---
POSTURE_ANGLE_THRESHOLD = 25.0  # 坐姿报警阈值：肩膀倾斜超过此度数报警
ABNORMAL_DURATION_THRESHOLD = 3.0 # 异常状态(坐姿/愤怒)持续多少秒才报警
ALERT_COOLDOWN = 30.0 # 报警冷却时间 (秒)
LONG_SITTING_THRESHOLD = 3600.0 # 久坐报警阈值 (秒)，默认 1 小时
ABSENCE_RESET_THRESHOLD = 30.0 # 离座重置阈值 (秒)
```

---

## 📂 项目结构

```
.
├── main.py                  # 主程序：监控、报警、记录数据
├── analyze_emotion.py       # 数据分析脚本：生成统计报告
├── emotion_monitor.db       # SQLite 数据库 (自动生成，存储情绪记录)
├── test_emotion_model.py    # (可选) 模型加载测试脚本
├── YoloV8-Human-Emotion-Detection/  
│   └── best.pt              # 表情识别模型权重
├── yolo11n-pose.pt          # 姿态估计模型权重 (自动下载)
└── README.md                # 项目说明文档
```

---

## ⚠️ 注意事项
- 请确保摄像头光线充足，以便模型准确识别面部和身体关键点。
- 坐姿检测主要基于上半身骨架，请尽量让肩膀出现在摄像头画面中。
